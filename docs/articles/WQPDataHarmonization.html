<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TADA">
<title>WQP Data Harmonization • TADA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="WQP Data Harmonization">
<meta property="og:description" content="TADA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TADA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/WQPDataHarmonization.html">WQP Data Harmonization</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/TADA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>WQP Data Harmonization</h1>
                        <h4 data-toc-skip class="author">Cristina
Mullin</h4>
            
            <h4 data-toc-skip class="date">May 1, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USEPA/TADA/blob/HEAD/vignettes/WQPDataHarmonization.Rmd" class="external-link"><code>vignettes/WQPDataHarmonization.Rmd</code></a></small>
      <div class="d-none name"><code>WQPDataHarmonization.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="install-and-load-packages">Install and load packages<a class="anchor" aria-label="anchor" href="#install-and-load-packages"></a>
</h2>
<p>Install and load dependency packages. Current versions of TADA and
dataRetrieval can be installed from GitHub instead of CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list.of.packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plyr"</span>,<span class="st">"dplyr"</span>,<span class="st">"ggplot2"</span>,<span class="st">"RColorBrewer"</span>,<span class="st">"Rcpp"</span>,<span class="st">"devtools"</span>,</span>
<span>          <span class="st">"data.table"</span>,<span class="st">"grDevices"</span>,<span class="st">"magrittr"</span>,<span class="st">"stringr"</span>,<span class="st">"testthat"</span>,<span class="st">"usethis"</span>,<span class="st">"utils"</span>,<span class="st">"stats"</span>,<span class="st">"rmarkdown"</span>,<span class="st">"knitr"</span>,<span class="st">"remotes"</span>, <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="va">new.packages</span> <span class="op">&lt;-</span> <span class="va">list.of.packages</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">list.of.packages</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span>,<span class="st">"Package"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">new.packages</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">new.packages</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rcpp.org" class="external-link">Rcpp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grDevices</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org" class="external-link">usethis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"USGS-R/dataRetrieval"</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"USEPA/TADA"</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">dataRetrieval</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usepa.github.io/TADA/" class="external-link">TADA</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="retrieve-wqp-data">Retrieve WQP data<a class="anchor" aria-label="anchor" href="#retrieve-wqp-data"></a>
</h2>
<p>WQP data is retrieved and processed for compatibility with TADA. This
function, TADAdataRetrieval builds on the USGS dataRetrieval package
functions. It joins three WQP profiles (i.e., the station, narrow, and
phys/chem), changes all data in the Characteristic, Speciation,
Fraction, and Unit fields to uppercase, removes true duplicates, removes
data for all non-water media types, and cleans results with special
characters.</p>
<p>This function uses the same inputs as the dataRetrieval
<code>readWQPdata</code> function. <code>readWQPdata</code> does not
restrict the characteristics pulled from WQP. You may specify the
desired characteristics by using, for instance: ’characteristicName =
“pH”.</p>
<p>More details about this function can be found in the function
documentation by entering the following code into the console:
?TADAdataRetrieval</p>
<p>Here is more information on the dataRetrieval R Package: <a href="https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html" class="external-link">Introduction
to the dataRetrieval package</a> <a href="https://rdrr.io/cran/dataRetrieval/man/readWQPdata.html" class="external-link">General
Data Import from Water Quality Portal</a> <a href="https://www.waterqualitydata.us/webservices_documentation/" class="external-link">Water
Quality Portal Web Services Guide</a> [dataRetrieval Tutorial](<a href="https://owi.usgs.gov/R/dataRetrieval.html" class="external-link uri">https://owi.usgs.gov/R/dataRetrieval.html</a></p>
<p>Water Quality Portal downloads have the same columns each time, but
be aware that data are uploaded to the Water Quality Portal by
individual organizations, which may or may not follow the same
conventions. Data and metadata quality are not guaranteed! Make sure to
carefully explore any data and make conservative quality assurance
decisions where information is limited.</p>
<p>In this vignette, we will walk through some of the things to look for
when deciding to use different organizations data from the WQP.</p>
<p>Tips on the WQP (<a href="https://www.waterqualitydata.us/" class="external-link uri">https://www.waterqualitydata.us/</a>) data retrieval
filters:</p>
<p>statecode startDatee countycode siteid siteType CharacteristicName
ActivityMediaName endDate</p>
<p>Tip 1) All the query filters for the WQP work as an AND but within
the fields there are ORs. So for example, characteristics – if you
choose pH &amp; DO – it’s an OR. Similarly, if you choose VA and IL,
it’s an OR. But the combo of fields are ANDs, such as State/VA AND
Characteristic/DO”. “Characteristic” and “Characteristic Type” on the
WQP also work as an AND. Tip 2) The “siteid” is a general term WQP uses
to describe both Site IDs from USGS databases and Monitoring Location
Identifiers (from the Water Quality Portal). Each monitoring location in
the Water Quality Portal (WQP) has a unique Monitoring Location
Identifier, regardless of the database from which it derives. The
Monitoring Location Identifier from the WQP is the concatenated
Organization Identifier plus the Site ID number. Site IDs that only
include a number are only unique identifiers for monitoring locations
within USGS NWIS or EPA’s WQX databases separately.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#You can edit this to define your own WQP query inputs below</span></span>
<span></span>
<span><span class="va">TADAProfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TADAdataRetrieval.html">TADAdataRetrieval</a></span><span class="op">(</span>statecode <span class="op">=</span> <span class="st">"UT"</span>, characteristicName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ammonia"</span>, <span class="st">"Nitrate"</span>, <span class="st">"Nitrogen"</span><span class="op">)</span>, startDate <span class="op">=</span> <span class="st">"01-01-2021"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Alternatively, use the data.table::fread function to read in a web service call for any WQP profile. </span></span>
<span><span class="va">new_fullphyschem</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"https://www.waterqualitydata.us/data/Result/search?countrycode=US&amp;statecode=US%3A49&amp;siteid=UTAHDWQ_WQX-4925610&amp;startDateLo=01-01-2015&amp;startDateHi=12-31-2016&amp;mimeType=csv&amp;zip=no&amp;sorted=yes&amp;dataProfile=fullPhysChem&amp;providers=NWIS&amp;providers=STEWARDS&amp;providers=STORET"</span><span class="op">)</span></span></code></pre></div>
<p>Review all column names in the TADA Profile</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">TADAProfile</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "OrganizationIdentifier"                           </span></span>
<span><span class="co">#&gt;   [2] "OrganizationFormalName"                           </span></span>
<span><span class="co">#&gt;   [3] "ActivityIdentifier"                               </span></span>
<span><span class="co">#&gt;   [4] "ActivityTypeCode"                                 </span></span>
<span><span class="co">#&gt;   [5] "ActivityMediaName"                                </span></span>
<span><span class="co">#&gt;   [6] "ActivityMediaSubdivisionName"                     </span></span>
<span><span class="co">#&gt;   [7] "ActivityStartDate"                                </span></span>
<span><span class="co">#&gt;   [8] "ActivityStartTime.Time"                           </span></span>
<span><span class="co">#&gt;   [9] "ActivityStartTime.TimeZoneCode"                   </span></span>
<span><span class="co">#&gt;  [10] "ActivityEndDate"                                  </span></span>
<span><span class="co">#&gt;  [11] "ActivityEndTime.Time"                             </span></span>
<span><span class="co">#&gt;  [12] "ActivityEndTime.TimeZoneCode"                     </span></span>
<span><span class="co">#&gt;  [13] "ActivityDepthHeightMeasure.MeasureValue"          </span></span>
<span><span class="co">#&gt;  [14] "ActivityDepthHeightMeasure.MeasureUnitCode"       </span></span>
<span><span class="co">#&gt;  [15] "ActivityDepthAltitudeReferencePointText"          </span></span>
<span><span class="co">#&gt;  [16] "ActivityTopDepthHeightMeasure.MeasureValue"       </span></span>
<span><span class="co">#&gt;  [17] "ActivityTopDepthHeightMeasure.MeasureUnitCode"    </span></span>
<span><span class="co">#&gt;  [18] "ActivityBottomDepthHeightMeasure.MeasureValue"    </span></span>
<span><span class="co">#&gt;  [19] "ActivityBottomDepthHeightMeasure.MeasureUnitCode" </span></span>
<span><span class="co">#&gt;  [20] "ProjectIdentifier"                                </span></span>
<span><span class="co">#&gt;  [21] "ActivityConductingOrganizationText"               </span></span>
<span><span class="co">#&gt;  [22] "MonitoringLocationIdentifier"                     </span></span>
<span><span class="co">#&gt;  [23] "ActivityCommentText"                              </span></span>
<span><span class="co">#&gt;  [24] "SampleAquifer"                                    </span></span>
<span><span class="co">#&gt;  [25] "HydrologicCondition"                              </span></span>
<span><span class="co">#&gt;  [26] "HydrologicEvent"                                  </span></span>
<span><span class="co">#&gt;  [27] "SampleCollectionMethod.MethodIdentifier"          </span></span>
<span><span class="co">#&gt;  [28] "SampleCollectionMethod.MethodIdentifierContext"   </span></span>
<span><span class="co">#&gt;  [29] "SampleCollectionMethod.MethodName"                </span></span>
<span><span class="co">#&gt;  [30] "SampleCollectionEquipmentName"                    </span></span>
<span><span class="co">#&gt;  [31] "ResultDetectionConditionText"                     </span></span>
<span><span class="co">#&gt;  [32] "CharacteristicName"                               </span></span>
<span><span class="co">#&gt;  [33] "ResultSampleFractionText"                         </span></span>
<span><span class="co">#&gt;  [34] "ResultMeasureValue"                               </span></span>
<span><span class="co">#&gt;  [35] "ResultMeasureValue.Original"                      </span></span>
<span><span class="co">#&gt;  [36] "TADA.ResultMeasureValue.Flag"                     </span></span>
<span><span class="co">#&gt;  [37] "ResultMeasure.MeasureUnitCode"                    </span></span>
<span><span class="co">#&gt;  [38] "MeasureQualifierCode"                             </span></span>
<span><span class="co">#&gt;  [39] "ResultStatusIdentifier"                           </span></span>
<span><span class="co">#&gt;  [40] "StatisticalBaseCode"                              </span></span>
<span><span class="co">#&gt;  [41] "ResultValueTypeName"                              </span></span>
<span><span class="co">#&gt;  [42] "ResultWeightBasisText"                            </span></span>
<span><span class="co">#&gt;  [43] "ResultTimeBasisText"                              </span></span>
<span><span class="co">#&gt;  [44] "ResultTemperatureBasisText"                       </span></span>
<span><span class="co">#&gt;  [45] "ResultParticleSizeBasisText"                      </span></span>
<span><span class="co">#&gt;  [46] "PrecisionValue"                                   </span></span>
<span><span class="co">#&gt;  [47] "ResultCommentText"                                </span></span>
<span><span class="co">#&gt;  [48] "USGSPCode"                                        </span></span>
<span><span class="co">#&gt;  [49] "ResultDepthHeightMeasure.MeasureValue"            </span></span>
<span><span class="co">#&gt;  [50] "ResultDepthHeightMeasure.MeasureUnitCode"         </span></span>
<span><span class="co">#&gt;  [51] "ResultDepthAltitudeReferencePointText"            </span></span>
<span><span class="co">#&gt;  [52] "SubjectTaxonomicName"                             </span></span>
<span><span class="co">#&gt;  [53] "SampleTissueAnatomyName"                          </span></span>
<span><span class="co">#&gt;  [54] "ResultAnalyticalMethod.MethodIdentifier"          </span></span>
<span><span class="co">#&gt;  [55] "ResultAnalyticalMethod.MethodIdentifierContext"   </span></span>
<span><span class="co">#&gt;  [56] "ResultAnalyticalMethod.MethodName"                </span></span>
<span><span class="co">#&gt;  [57] "MethodDescriptionText"                            </span></span>
<span><span class="co">#&gt;  [58] "LaboratoryName"                                   </span></span>
<span><span class="co">#&gt;  [59] "AnalysisStartDate"                                </span></span>
<span><span class="co">#&gt;  [60] "ResultLaboratoryCommentText"                      </span></span>
<span><span class="co">#&gt;  [61] "DetectionQuantitationLimitTypeName"               </span></span>
<span><span class="co">#&gt;  [62] "DetectionQuantitationLimitMeasure.MeasureValue"   </span></span>
<span><span class="co">#&gt;  [63] "DetectionLimitMeasureValue.Original"              </span></span>
<span><span class="co">#&gt;  [64] "TADA.DetectionLimitMeasureValue.Flag"             </span></span>
<span><span class="co">#&gt;  [65] "DetectionQuantitationLimitMeasure.MeasureUnitCode"</span></span>
<span><span class="co">#&gt;  [66] "PreparationStartDate"                             </span></span>
<span><span class="co">#&gt;  [67] "ProviderName"                                     </span></span>
<span><span class="co">#&gt;  [68] "ActivityStartDateTime"                            </span></span>
<span><span class="co">#&gt;  [69] "ActivityEndDateTime"                              </span></span>
<span><span class="co">#&gt;  [70] "MonitoringLocationName"                           </span></span>
<span><span class="co">#&gt;  [71] "MonitoringLocationTypeName"                       </span></span>
<span><span class="co">#&gt;  [72] "MonitoringLocationDescriptionText"                </span></span>
<span><span class="co">#&gt;  [73] "HUCEightDigitCode"                                </span></span>
<span><span class="co">#&gt;  [74] "DrainageAreaMeasure.MeasureValue"                 </span></span>
<span><span class="co">#&gt;  [75] "DrainageAreaMeasure.MeasureUnitCode"              </span></span>
<span><span class="co">#&gt;  [76] "ContributingDrainageAreaMeasure.MeasureValue"     </span></span>
<span><span class="co">#&gt;  [77] "ContributingDrainageAreaMeasure.MeasureUnitCode"  </span></span>
<span><span class="co">#&gt;  [78] "LatitudeMeasure"                                  </span></span>
<span><span class="co">#&gt;  [79] "LongitudeMeasure"                                 </span></span>
<span><span class="co">#&gt;  [80] "SourceMapScaleNumeric"                            </span></span>
<span><span class="co">#&gt;  [81] "HorizontalAccuracyMeasure.MeasureValue"           </span></span>
<span><span class="co">#&gt;  [82] "HorizontalAccuracyMeasure.MeasureUnitCode"        </span></span>
<span><span class="co">#&gt;  [83] "HorizontalCollectionMethodName"                   </span></span>
<span><span class="co">#&gt;  [84] "HorizontalCoordinateReferenceSystemDatumName"     </span></span>
<span><span class="co">#&gt;  [85] "VerticalMeasure.MeasureValue"                     </span></span>
<span><span class="co">#&gt;  [86] "VerticalMeasure.MeasureUnitCode"                  </span></span>
<span><span class="co">#&gt;  [87] "VerticalAccuracyMeasure.MeasureValue"             </span></span>
<span><span class="co">#&gt;  [88] "VerticalAccuracyMeasure.MeasureUnitCode"          </span></span>
<span><span class="co">#&gt;  [89] "VerticalCollectionMethodName"                     </span></span>
<span><span class="co">#&gt;  [90] "VerticalCoordinateReferenceSystemDatumName"       </span></span>
<span><span class="co">#&gt;  [91] "CountryCode"                                      </span></span>
<span><span class="co">#&gt;  [92] "StateCode"                                        </span></span>
<span><span class="co">#&gt;  [93] "CountyCode"                                       </span></span>
<span><span class="co">#&gt;  [94] "AquiferName"                                      </span></span>
<span><span class="co">#&gt;  [95] "LocalAqfrName"                                    </span></span>
<span><span class="co">#&gt;  [96] "FormationTypeText"                                </span></span>
<span><span class="co">#&gt;  [97] "AquiferTypeName"                                  </span></span>
<span><span class="co">#&gt;  [98] "ConstructionDateText"                             </span></span>
<span><span class="co">#&gt;  [99] "WellDepthMeasure.MeasureValue"                    </span></span>
<span><span class="co">#&gt; [100] "WellDepthMeasure.MeasureUnitCode"                 </span></span>
<span><span class="co">#&gt; [101] "WellHoleDepthMeasure.MeasureValue"                </span></span>
<span><span class="co">#&gt; [102] "WellHoleDepthMeasure.MeasureUnitCode"             </span></span>
<span><span class="co">#&gt; [103] "MethodSpecificationName"                          </span></span>
<span><span class="co">#&gt; [104] "ProjectName"                                      </span></span>
<span><span class="co">#&gt; [105] "ProjectDescriptionText"                           </span></span>
<span><span class="co">#&gt; [106] "SamplingDesignTypeCode"                           </span></span>
<span><span class="co">#&gt; [107] "QAPPApprovedIndicator"                            </span></span>
<span><span class="co">#&gt; [108] "QAPPApprovalAgencyName"                           </span></span>
<span><span class="co">#&gt; [109] "ProjectFileUrl"                                   </span></span>
<span><span class="co">#&gt; [110] "ProjectMonitoringLocationWeightingUrl"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="depth-unit-conversions">Depth unit conversions<a class="anchor" aria-label="anchor" href="#depth-unit-conversions"></a>
</h2>
<p>Converts depth units to a consistent unit.</p>
<p><strong>ActivityDepthHeightMeasure.MeasureValue</strong> provides
depth information. This is a crucial column for lake data but less often
for river data.</p>
<p>Function checks dataset for depth profile data. Where depth profile
columns are populated, the function appends ‘Conversion Factor’ columns
and populates those columns based on the original unit (MeasureUnitCode
columns) and the target unit, which is defined in the ‘unit’ argument. A
‘Depth Target Unit’ column is also appended, indicating the unit all
selected depth data is converted to. When transform = FALSE, the output
includes all ‘Conversion Factor’ columns and the ‘Depth Target Unit’
column. When transform = TRUE, the output includes converted depth data
and the ‘Depth Target Unit’ column, which acts as a flag indicating
which rows have been converted. Default is transform = TRUE.</p>
<p>The depth profile function can harmonize the depth units across all
the following fields (or only a specific one):
“ActivityDepthHeightMeasure”, “ActivityTopDepthHeightMeasure”,
“ActivityBottomDepthHeightMeasure”, “ResultDepthHeightMeasure”). The
default is all.</p>
<p>Allowable values for ‘unit’ are either ‘m’ (meter), ‘ft’ (feet), or
‘in’ (inch). ‘unit’ accepts only one allowable value as an input.
Default is unit = “m”.</p>
<p>See additional function documentation for additional function options
by entering the following code in the console: ?DepthProfileData</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#converts all depth profile data to meters</span></span>
<span><span class="va">TADAProfileClean1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DepthProfileData.html">DepthProfileData</a></span><span class="op">(</span><span class="va">TADAProfile</span>, unit <span class="op">=</span> <span class="st">"m"</span>, transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="result-unit-conversions">Result unit conversions<a class="anchor" aria-label="anchor" href="#result-unit-conversions"></a>
</h2>
<p>Converts all results to WQX target units. WQX target units are pulled
from the MeasureUnit domain table: <a href="https://cdx2.epa.gov/wqx/download/DomainValues/MeasureUnit.CSV" class="external-link uri">https://cdx2.epa.gov/wqx/download/DomainValues/MeasureUnit.CSV</a></p>
<p>See additional function documentation for additional function options
by entering the following code in the console: ?WQXTargetUnits</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Converts all results to WQX target units</span></span>
<span><span class="va">TADAProfileClean2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/WQXTargetUnits.html">WQXTargetUnits</a></span><span class="op">(</span><span class="va">TADAProfileClean1</span>, transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="statistically-aggregated-data">Statistically aggregated data<a class="anchor" aria-label="anchor" href="#statistically-aggregated-data"></a>
</h2>
<p>Checks for and removes statistically aggregated high freqeuncy (i.e.,
continuous) data, if present.</p>
<p>The Water Quality Portal (WQP) is not designed to store
high-frequency sensor data. However, sometimes data providers choose to
aggregate their continuous data and submit it to WQP as one value. This
type of data may not be suitable for integration with discrete water
quality data for assessments. Therefore, this function uses metadata
submitted by data providers to flags rows with aggregated continuous
data. This is done by flagging results where the
ResultDetectionConditionText = “Reported in Raw Data (attached)”. When
clean = TRUE, rows with aggregated continuous data are removed from the
dataset and no column will be appended. Default is clean = TRUE.</p>
<p>See function documentation for additional function options by
entering the following code in the console: ?DepthProfileData</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AggregatedContinuousData.html">AggregatedContinuousData</a></span><span class="op">(</span><span class="va">TADAProfileClean2</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The dataset does not contain aggregated continuous data."</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wqx-qaqc-service-result-flags">WQX QAQC Service Result Flags<a class="anchor" aria-label="anchor" href="#wqx-qaqc-service-result-flags"></a>
</h2>
<p>Run the following result functions to address invalid method,
fraction, speciation, and unit metadata by characteristic. The default
is Clean=TRUE, which will remove invalid results. You can change this to
clean=FALSE to flag results, but not remove them.</p>
<p>See documentation for more details: ?InvalidMethod ?InvalidSpeciation
?InvalidResultUnit ?InvalidFraction</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvalidMethod.html">InvalidMethod</a></span><span class="op">(</span><span class="va">TADAProfileClean3</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">TADAProfileClean5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvalidFraction.html">InvalidFraction</a></span><span class="op">(</span><span class="va">TADAProfileClean4</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "All data is valid, therefore the function cannot be applied."</span></span>
<span><span class="va">TADAProfileClean6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvalidSpeciation.html">InvalidSpeciation</a></span><span class="op">(</span><span class="va">TADAProfileClean5</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">TADAProfileClean7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvalidResultUnit.html">InvalidResultUnit</a></span><span class="op">(</span><span class="va">TADAProfileClean6</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wqx-national-upper-and-lower-thresholds">WQX national upper and lower thresholds<a class="anchor" aria-label="anchor" href="#wqx-national-upper-and-lower-thresholds"></a>
</h2>
<p>Run the following code to flag or remove results that are above or
below the national upper and lower bound for each characteristic and
unit combination. The default is clean=TRUE, but you can change this to
only flag results if desired. Results will be flagged, but not removed,
when clean=FALSE.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AboveNationalWQXUpperThreshold.html">AboveNationalWQXUpperThreshold</a></span><span class="op">(</span><span class="va">TADAProfileClean7</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">TADAProfileClean9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BelowNationalWQXUpperThreshold.html">BelowNationalWQXUpperThreshold</a></span><span class="op">(</span><span class="va">TADAProfileClean8</span>, clean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="potential-duplicates">Potential duplicates<a class="anchor" aria-label="anchor" href="#potential-duplicates"></a>
</h2>
<p>Sometimes multiple organizations submit the exact same data to Water
Quality Portal (WQP), which can affect water quality analyses and
assessments. This function checks for and identifies data that is
identical in all fields excluding organization-specific and comment text
fields. Each pair or group of potential duplicate rows is flagged with a
unique ID. When clean = TRUE, the function retains the first occurrence
of each potential duplicate in the dataset. Default is clean = TRUE.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PotentialDuplicateRowID.html">PotentialDuplicateRowID</a></span><span class="op">(</span><span class="va">TADAProfileClean9</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="invalid-coordinates">Invalid coordinates<a class="anchor" aria-label="anchor" href="#invalid-coordinates"></a>
</h2>
<p>Function identifies and flags invalid coordinate data. When
clean_outsideUSA = FALSE and clean_imprecise = FALSE, a column will be
appended titled “TADA.InvalidCoordinates” with the following flags (if
relevant to dataset). If the latitude is less than zero, the row will be
flagged with “LAT_OutsideUSA”. If the longitude is greater than zero AND
less than 145, the row will be flagged as “LONG_OutsideUSA”. If the
latitude or longitude contains the string, “999”, the row will be
flagged as invalid. Finally, precision can be measured by the number of
decimal places in the latitude and longitude provided. If either does
not have any numbers to the right of the decimal point, the row will be
flagged as “Imprecise”.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvalidCoordinates.html">InvalidCoordinates</a></span><span class="op">(</span><span class="va">TADAProfileClean10</span>, clean_outsideUSA <span class="op">=</span> <span class="cn">FALSE</span>, clean_imprecise <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="review-qapp-information">Review QAPP information<a class="anchor" aria-label="anchor" href="#review-qapp-information"></a>
</h2>
<p>Check data for an approved QAPP</p>
<p>This function checks to see if there is any information in the column
“QAPPApprovedIndicator”. Some organizations submit data for this field
to indicate if the data produced has an approved Quality Assurance
Project Plan (QAPP) or not. In this field, Y indicates yes, N indicates
no.</p>
<p>This function has two default inputs: clean = TRUE and cleanNA =
FALSE. These defaults remove rows of data where the
QAPPApprovedIndicator equals “N”. Users could alternatively remove both
N’s and NA’s using the inputs clean = TRUE and cleanNA = TRUE. If both
clean = FALSE and cleanNA = FALSE, the function will not do
anything.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QAPPapproved.html">QAPPapproved</a></span><span class="op">(</span><span class="va">TADAProfileClean11</span>, clean <span class="op">=</span> <span class="cn">TRUE</span>, cleanNA <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Check to see if a QAPP Doc is Available</p>
<p>This function checks data submitted under the “ProjectFileUrl” column
to determine if a QAPP document is available to review. When clean =
FALSE, a column will be appended to flag results that do have an
associated QAPP document URL provided. When clean = TRUE, rows that do
not have an associated QAPP document are removed from the dataset and no
column will be appended. This function should only be used to remove
data if an accompanying QAPP document is required to use data in
assessments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QAPPDocAvailable.html">QAPPDocAvailable</a></span><span class="op">(</span><span class="va">TADAProfileClean12</span>, clean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in QAPPDocAvailable(TADAProfileClean12, clean = FALSE): The dataset does</span></span>
<span><span class="co">#&gt; not contain QAPP document url data.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filter-data-by-field">Filter data by field<a class="anchor" aria-label="anchor" href="#filter-data-by-field"></a>
</h2>
<p>In this section a TADA user will want to review the unique values in
specific fields and may choose to remove data with particular
values.</p>
<p>To start, review the list of fields and the number of unique values
in each field.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterFields.html">FilterFields</a></span><span class="op">(</span><span class="va">TADAProfileClean13</span><span class="op">)</span></span>
<span><span class="co">#&gt;                             FieldName Count</span></span>
<span><span class="co">#&gt; 1              OrganizationFormalName     4</span></span>
<span><span class="co">#&gt; 2                    ActivityTypeCode     5</span></span>
<span><span class="co">#&gt; 3                   ActivityMediaName     1</span></span>
<span><span class="co">#&gt; 4        ActivityMediaSubdivisionName     4</span></span>
<span><span class="co">#&gt; 5                 ActivityCommentText     2</span></span>
<span><span class="co">#&gt; 6                 HydrologicCondition     8</span></span>
<span><span class="co">#&gt; 7                     HydrologicEvent     4</span></span>
<span><span class="co">#&gt; 8                  CharacteristicName     2</span></span>
<span><span class="co">#&gt; 9                MeasureQualifierCode     1</span></span>
<span><span class="co">#&gt; 10            SampleTissueAnatomyName     1</span></span>
<span><span class="co">#&gt; 11                     LaboratoryName     8</span></span>
<span><span class="co">#&gt; 12 DetectionQuantitationLimitTypeName     4</span></span>
<span><span class="co">#&gt; 13         MonitoringLocationTypeName     6</span></span>
<span><span class="co">#&gt; 14                        ProjectName     3</span></span></code></pre></div>
<p>Next, choose a field from the list to see the unique values in that
field, as well as the number of times each value appears in the dataset.
We’ll start with ActivityTypeCode.</p>
<p>Here is a list of other fields to review: 1.
<strong>ResultCommentText</strong> often has details relating to
additional QA. 2. <strong>MeasureQualifierCode</strong> Contains
information about data flags 3. Other codes may designate suspect data
or other flags which may be described in detail in
<strong>ResultLaboratoryCommentText</strong> or another column</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterFieldReview.html">FilterFieldReview</a></span><span class="op">(</span><span class="st">"ActivityTypeCode"</span>, <span class="va">TADAProfileClean13</span><span class="op">)</span></span></code></pre></div>
<p><img src="WQPDataHarmonization_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt;                               FieldValue Count</span></span>
<span><span class="co">#&gt; 5                         Sample-Routine   799</span></span>
<span><span class="co">#&gt; 3 Quality Control Sample-Field Replicate    50</span></span>
<span><span class="co">#&gt; 1                          Field Msr/Obs     4</span></span>
<span><span class="co">#&gt; 2     Quality Control Sample-Field Blank     1</span></span>
<span><span class="co">#&gt; 4   Quality Control Sample-Lab Duplicate     1</span></span></code></pre>
<p>The ActivityTypeCode field has four unique values – “Sample-Routine”,
“Quality Control Sample-Field Replicate”, “Field Msr/Obs”, and “Quality
Control Sample-Field Blank.” In this example we want to remove quality
control values in the ActivityTypeCode field, therefore, we’ll specify
that we want to remove the “Quality Control Sample-Field Replicate” and
“Quality Control Sample-Field Blank” values in the ActivityTypeCode
field.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean14</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TADAProfileClean13</span>, <span class="op">!</span><span class="op">(</span><span class="va">ActivityTypeCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quality Control Sample-Field Replicate"</span>, <span class="st">"Quality Control Sample-Field Blank"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We’ve completed our review of the ActivityTypeCode field.</p>
<p>Let’s move on to a different field and see if there are any values
that we want to remove – we’ll look at the values in the
ResultStatusIdentifier field.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterFieldReview.html">FilterFieldReview</a></span><span class="op">(</span><span class="st">"ActivityMediaSubdivisionName"</span>, <span class="va">TADAProfileClean14</span><span class="op">)</span></span></code></pre></div>
<p><img src="WQPDataHarmonization_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt;        FieldValue Count</span></span>
<span><span class="co">#&gt; 3   Surface Water   677</span></span>
<span><span class="co">#&gt; 2     Groundwater   106</span></span>
<span><span class="co">#&gt; 1 Bulk deposition     1</span></span></code></pre>
<p>The ActivityMediaSubdivisionName field has two unique values,
“Surface Water” and “Groundwater.” In this example we want to remove the
“Groundwater” values.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean15</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TADAProfileClean14</span>, <span class="op">!</span><span class="op">(</span><span class="va">ActivityMediaSubdivisionName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Groundwater"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filter-data-by-field-subset-by-parameter">Filter data by field, subset by parameter<a class="anchor" aria-label="anchor" href="#filter-data-by-field-subset-by-parameter"></a>
</h2>
<p>In this section a TADA user will want to select a parameter, review
the unique values associated with that parameter in specific fields, and
choose to remove particular values.</p>
<p>To start, review the list of parameters in the dataset. (The list is
sorted from highest to lowest counts. Only the first few rows are
displayed to save space on the page)</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterParList.html">FilterParList</a></span><span class="op">(</span><span class="va">TADAProfileClean15</span><span class="op">)</span></span>
<span><span class="co">#&gt;   FieldValue Count</span></span>
<span><span class="co">#&gt; 1    NITRATE   641</span></span>
<span><span class="co">#&gt; 2   NITROGEN    57</span></span></code></pre></div>
<p>Next, select a parameter. Let’s explore the fields associated with
Nitrogen:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterParFields.html">FilterParFields</a></span><span class="op">(</span><span class="va">TADAProfileClean15</span>, <span class="st">"NITROGEN"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                         FieldName Count</span></span>
<span><span class="co">#&gt; 1                                ActivityTypeCode     1</span></span>
<span><span class="co">#&gt; 2                               ActivityMediaName     1</span></span>
<span><span class="co">#&gt; 3                    ActivityMediaSubdivisionName     1</span></span>
<span><span class="co">#&gt; 4                             ActivityCommentText     1</span></span>
<span><span class="co">#&gt; 5                             HydrologicCondition     6</span></span>
<span><span class="co">#&gt; 6                                 HydrologicEvent     1</span></span>
<span><span class="co">#&gt; 7         SampleCollectionMethod.MethodIdentifier     5</span></span>
<span><span class="co">#&gt; 8  SampleCollectionMethod.MethodIdentifierContext     1</span></span>
<span><span class="co">#&gt; 9               SampleCollectionMethod.MethodName     5</span></span>
<span><span class="co">#&gt; 10                  SampleCollectionEquipmentName     5</span></span>
<span><span class="co">#&gt; 11                       ResultSampleFractionText     1</span></span>
<span><span class="co">#&gt; 12                  ResultMeasure.MeasureUnitCode     2</span></span>
<span><span class="co">#&gt; 13                           MeasureQualifierCode     1</span></span>
<span><span class="co">#&gt; 14                         ResultStatusIdentifier     2</span></span>
<span><span class="co">#&gt; 15                            ResultValueTypeName     1</span></span>
<span><span class="co">#&gt; 16                          ResultWeightBasisText     1</span></span>
<span><span class="co">#&gt; 17                     ResultTemperatureBasisText     1</span></span>
<span><span class="co">#&gt; 18                    ResultParticleSizeBasisText     1</span></span>
<span><span class="co">#&gt; 19                              ResultCommentText     2</span></span>
<span><span class="co">#&gt; 20        ResultAnalyticalMethod.MethodIdentifier     1</span></span>
<span><span class="co">#&gt; 21 ResultAnalyticalMethod.MethodIdentifierContext     1</span></span>
<span><span class="co">#&gt; 22              ResultAnalyticalMethod.MethodName     1</span></span>
<span><span class="co">#&gt; 23                          MethodDescriptionText     1</span></span>
<span><span class="co">#&gt; 24                                 LaboratoryName     1</span></span>
<span><span class="co">#&gt; 25                    ResultLaboratoryCommentText     5</span></span>
<span><span class="co">#&gt; 26             DetectionQuantitationLimitTypeName     1</span></span>
<span><span class="co">#&gt; 27                     MonitoringLocationTypeName     1</span></span></code></pre></div>
<p>Selecting a parameter generates the list below, which is subset by
the selected parameter, of fields and the number of unique values in
each field.</p>
<p>Then choose a field from the list. In this example we’ll remove
certain values from the HydrologicEvent field.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterParFieldReview.html">FilterParFieldReview</a></span><span class="op">(</span><span class="st">"HydrologicEvent"</span>, <span class="va">TADAProfileClean15</span>, <span class="st">"NITROGEN"</span><span class="op">)</span></span></code></pre></div>
<p><img src="WQPDataHarmonization_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt;       FieldValue Count</span></span>
<span><span class="co">#&gt; 1 Routine sample    57</span></span></code></pre>
<p>The HydrologicEvent field has three unique values. In this example we
want to remove samples collected during “Storm” events. Therefore, we’ll
specify that we want to remove rows where the CharacteristicName is
“NITROGEN” and the HydrologicEvent field is “Storm.”</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TADAProfileClean16</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TADAProfileClean15</span>, <span class="op">!</span><span class="op">(</span><span class="va">CharacteristicName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"NITROGEN"</span> <span class="op">&amp;</span> <span class="va">HydrologicEvent</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Storm"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transform-characteristic-speciation-and-unit-values-to-tada-standards">Transform Characteristic, Speciation, and Unit values to TADA
Standards<a class="anchor" aria-label="anchor" href="#transform-characteristic-speciation-and-unit-values-to-tada-standards"></a>
</h2>
<p>The HarmonizeRefTable function generates a harmonization reference
table that is specific to the input dataset. Users can review how their
input data relates to standard TADA values for CharacteristicName,
ResultSampleFractionText, MethodSpecicationName, and
ResultMeasure.MeasureUnitCode and they can optionally edit the reference
file to meet their needs. The download argument can be used to save the
harmonization file to your current working directory when download =
TRUE, the default is download = FALSE.</p>
<p>The HarmonizeData function then compares the input dataset to the
TADA Harmonization Reference Table. The purpose of the function is to
make similar data consistent and therefore easier to compare and
analyze. Optional outputs include: 1) the dataset with Harmonization
columns appended, 2) the datset with CharacteristicName,
ResultSampleFractionText, MethodSpecificationName, and
ResultMeasure.MeasureUnitCode converted to TADA standards or 3) the four
fields converted with most Harmonization Reference Table columns
appended. Default is transform = TRUE and flag = TRUE.</p>
<p>Here are some examples of how the HarmonizeData function can be used:
1. <strong>ResultSampleFractionText</strong> specifies forms of
constituents. In some cases, a single
<strong>CharacteristicName</strong> will have both “Total” and
“Dissolved” forms specified, which should not be combined. In these
cases, each CharacteristicName and ResultSampleFractionText combination
is given a different identifier. This identifier can be used later on to
identify comparable data groups for calculating statistics and creating
figures for each combination. 2. Some variables have different names but
represent the same constituent (e.g., “Total Kjeldahl nitrogen (Organic
N &amp; NH3)” and “Kjeldahl nitrogen”). The HarmonizeData function gives
a consistent name (and identifier) to synonyms.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UniqueHarmonizationRef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HarmonizationRefTable.html">HarmonizationRefTable</a></span><span class="op">(</span><span class="va">TADAProfileClean16</span>, download <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">TADAProfileClean17</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HarmonizeData.html">HarmonizeData</a></span><span class="op">(</span><span class="va">TADAProfileClean16</span>, ref <span class="op">=</span> <span class="va">UniqueHarmonizationRef</span>, transform <span class="op">=</span> <span class="cn">TRUE</span>, flag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cristina Mullin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
